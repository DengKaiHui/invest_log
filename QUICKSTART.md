# 🚀 快速入门指南

## 方式一：使用启动脚本（推荐）

```bash
./start.sh
```

然后按提示操作即可！

---

## 方式二：手动启动

### 第一步：安装依赖

```bash
npm install
```

### 第二步：启动后端服务

```bash
npm start
```

你会看到类似输出：
```
🚀 股票价格服务已启动
📡 服务地址: http://localhost:3001
⏱  缓存时间: 30 分钟
🔄 自动刷新: 每5分钟检查过期缓存
```

### 第三步：启动前端（新开终端）

```bash
# 方式1: 使用 Python（推荐）
python3 -m http.server 8000

# 方式2: 使用 VS Code Live Server
# 右键 index.html -> Open with Live Server
```

### 第四步：访问应用

在浏览器打开：`http://localhost:8000/index.html`

---

## 测试后端服务

确保后端服务已启动，然后新开终端：

```bash
npm test
```

你会看到完整的测试报告！

---

## 使用说明

### 1️⃣ 添加投资记录

在"记一笔"卡片中：
- 输入资产名称（如：NVDA）
- 选择交易日期
- 输入总金额和单价
- 点击提交

### 2️⃣ 查看持仓盈亏

在"持仓盈亏"卡片中：
- 自动显示每个标的的成本、现价、盈亏
- 点击"刷新价格"获取最新价格
- 第一次点击后会缓存30分钟

### 3️⃣ 价格更新逻辑

- **首次加载**：自动从缓存获取（如果有）
- **缓存有效期**：30分钟
- **自动刷新**：后端每5分钟检查并更新过期缓存
- **手动刷新**：点击按钮强制更新

---

## 常见问题

### ❓ 提示"无法连接到价格服务"

**答：** 后端服务未启动或端口被占用

**解决：**
```bash
# 检查后端是否运行
curl http://localhost:3001/api/health

# 如果没有响应，启动后端
npm start
```

### ❓ 价格显示为"--"

**答：** 股票代码可能不正确或网络问题

**解决：**
1. 确认股票代码（使用 Yahoo Finance 的代码）
2. 检查网络连接
3. 查看后端控制台的错误日志

### ❓ 如何修改端口号？

**后端端口** (默认 3001)：
编辑 `server.js`：
```javascript
const PORT = 3001; // 改为你想要的端口
```

同时编辑 `src/utils/api.js`：
```javascript
const API_BASE_URL = 'http://localhost:3001/api'; // 同步修改
```

**前端端口** (默认 8000)：
```bash
python3 -m http.server 你的端口号
```

---

## 🎯 功能亮点

### 智能缓存
- ✅ 减少 API 调用，避免被限流
- ✅ 提高响应速度（缓存瞬间返回）
- ✅ 节省网络资源

### 自动刷新
- ✅ 后台定时更新过期数据
- ✅ 无需手动干预
- ✅ 始终保持数据新鲜

### 批量操作
- ✅ 一次性获取多个股票价格
- ✅ 智能限流（每个股票间隔200ms）
- ✅ 避免请求过快导致失败

---

## 📊 架构说明

```
┌─────────────┐         ┌──────────────┐         ┌─────────────────┐
│             │         │              │         │                 │
│  前端页面   │◄──────►│ 后端服务器   │◄──────►│ Yahoo Finance   │
│ (Vue3 +    │   HTTP  │ (Node.js +   │   API   │                 │
│  Element)  │         │  Express)    │         │                 │
│             │         │              │         │                 │
└─────────────┘         └──────────────┘         └─────────────────┘
      │                        │
      │                        │
      ▼                        ▼
┌─────────────┐         ┌──────────────┐
│ LocalStorage│         │  内存缓存     │
│  (持久化)   │         │  (30分钟)    │
└─────────────┘         └──────────────┘
```

---

## 📝 开发建议

### 开发模式

使用 watch 模式，代码修改后自动重启：
```bash
npm run dev
```

### 查看缓存状态

```bash
curl http://localhost:3001/api/cache/status | json_pp
```

### 清除缓存

```bash
curl -X DELETE http://localhost:3001/api/cache
```

---

## 🎉 开始使用吧！

一切就绪，享受你的投资管理之旅！ 📈💰

如有问题，请查看 [START_SERVER.md](START_SERVER.md) 获取详细信息。
